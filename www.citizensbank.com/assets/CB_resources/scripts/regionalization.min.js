let regionalizedList,GEOCODEAPI_URL,isRegionalized=!1,isOpen=!1;const zipCodeSubmit=document.getElementById("cbds-modal");let zipCodeVal="",url=window.location.href,HOST=window.location.host,BASE_URL="";url=url.split("/");let PROTOCOL=url[0];BASE_URL=PROTOCOL+"//"+url[2];let regionCookie,regionCookieTemp,regionMetaTag,regionListMetaTag,MAX_COOKIE_DAYS=30,REGIONSERVICE_URL="/apps/ApiProxy/RegionalizationApi/api/region/GetRegion?ZipCode=",itemFocus=".modal-trigger",keyFlag=!0,GOOGLE_MAPS_API_ZIPCODE_URL="/regionalizationgeoapi/api/GeoCoding?Latitude=",ZIP_CONFIG_URL=BASE_URL+REGIONSERVICE_URL;GEOCODEAPI_URL="https://sit1.qacitizensbank.com"==BASE_URL?"https://services.devcitizensbank.com":"https://qa1.qacitizensbank.com"==BASE_URL||"https://qa3.qacitizensbank.com"==BASE_URL?"https://services.qacitizensbank.com":"https://services.citizensbank.com";let GOOGLE_MAPS_ZIP_CONFIG_URL=GEOCODEAPI_URL+GOOGLE_MAPS_API_ZIPCODE_URL,isMobileOrTab=Foundation.utils.is_small_only();const getCookie=e=>{let t=e+"=",o=decodeURIComponent(document.cookie).split(";");for(let e=0;e<o.length;e++){let n=o[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},setRegionalized=e=>{isRegionalized=e},setIsOpen=e=>{isOpen=!0},setRegionalizedList=e=>{e?(document.getElementById("content-outfootprint")?.classList.add("cbds-u-display__none"),document.getElementById("content-infootprint")?.classList.remove("cbds-u-display__none"),setIsOF(!1)):(document.getElementById("content-infootprint")?.classList.add("cbds-u-display__none"),document.getElementById("content-outfootprint")?.classList.remove("cbds-u-display__none"),setIsOF(!0))},isRegionalizedPage=()=>{regionCookie=getCookie("Region");let e=getCookie("RegionTemp"),t=getCookie("Region");const o=e=>{document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"};let n,i,d,s;if(e&&t&&(o("RegionTemp"),o("Region"),setCookie("RegionTemp",e,MAX_COOKIE_DAYS),setCookie("Region",t,MAX_COOKIE_DAYS),regionCookieTemp=getCookie("RegionTemp")),void 0===regionCookieTemp||""===regionCookieTemp?$("#dcom-c-zipcomponent-update .dcom-c-zipcomponent-span").text("Change Zipcode"):(n=regionCookie.split("&")[0].split("=")[1],i=regionCookie.split("&")[1].split("=")[1],d=regionCookieTemp.split("&")[0].split("=")[1],s=regionCookieTemp.split("&")[1].split("=")[1],$("#dcom-c-zipcomponent-update .dcom-c-zipcomponent-span").text(s),setIsOF("OF"===d)),null!=regionMetaTag&&null!=regionListMetaTag){const e=regionMetaTag.content;let t=regionListMetaTag.content.includes(d);if(t||"false"===e){if(t&&n!==d){let e=["RegionID=",d,"&Zip=",s].join("");setCookie("Region",e,MAX_COOKIE_DAYS)}}else{let e=["RegionID=","RI","&Zip=","02919"].join("");setCookie("Region",e,MAX_COOKIE_DAYS)}setRegionalized(e),t?(document.getElementById("content-outfootprint")?.classList.add("cbds-u-display__none"),document.getElementById("content-infootprint")?.classList.remove("cbds-u-display__none"),setIsOF(!1)):(document.getElementById("content-infootprint")?.classList.add("cbds-u-display__none"),document.getElementById("content-outfootprint")?.classList.remove("cbds-u-display__none"),setIsOF(!0)),getValueFromCookie()}else setRegionalized(!1)},getValueFromCookie=()=>{regionCookie=getCookie("Region"),regionCookieTemp=getCookie("RegionTemp"),void 0===regionCookie||""===regionCookie||void 0===regionCookieTemp||""===regionCookieTemp?isMobileOrTab&&isRegionalized&&handleGeolocation():zipCodeVal=regionCookieTemp.split("&")[1].split("=")[1]},handleGeolocation=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(success,error):(console.log("Geolocation not supported"),getRegionZipCode("02919"))},success=e=>{setCookie("MOBILE_TRACKING_OFF","false",MAX_COOKIE_DAYS),$.ajax({url:GOOGLE_MAPS_ZIP_CONFIG_URL+e.coords.latitude+"&Longitude="+e.coords.longitude,dataType:"json"}).done((e=>{let t=getZipCodeFromRespOfGoogleApi(e);getRegionZipCode(t)})).fail((function(){console.log("Geolocation api failed"),getRegionZipCode("02919")}))},getZipCodeFromRespOfGoogleApi=e=>{let t=!1,o="";return"OK"!==e.status?"":(e.results.map(((e,n)=>{if(e.address_components.map(((e,n)=>(!e.types||(e.types.map(((n,i)=>{if("postal_code"===n)return t=!0,o=e.long_name,!1})),!t))&&(!t&&void 0))),t)return!1})),o)},error=()=>{isRegionalized&&setCookie("MOBILE_TRACKING_OFF","true",MAX_COOKIE_DAYS),getRegionZipCode("02919"),console.log("Unable to retrieve your location")},openModal=()=>{setIsOpen(),document.getElementById("dcom-zip-modal-submit")?.classList.add("cbds-is-disabled"),document.getElementById("cbds-textInput").value="",document.getElementById("cbds-textInput")?.classList.remove("cbds-is-invalid"),document.getElementById("cbds-textInput").setAttribute("aria-invalid",!1),document.getElementById("cbds-textInput")?.nextElementSibling.classList.add("cbds-u-display__none"),showZipCodeModal()},showZipCodeModal=()=>{document.querySelector("#cbds-modal").classList.remove("cbds-u-display__none")},hideZipCodeModal=()=>{document.querySelector("#cbds-modal").classList.add("cbds-u-display__none")},showError=e=>{e.classList.add("cbds-is-invalid"),e.setAttribute("aria-invalid",!0),e.nextElementSibling.classList.remove("cbds-u-display__none")},hideError=e=>{e.classList.remove("cbds-is-invalid"),e.setAttribute("aria-invalid",!1),e.nextElementSibling.classList.add("cbds-u-display__none")},onlyNumberKey=e=>{let t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))||(e.preventDefault(),!1)};function checkTabPress(e){isOpen&&"Tab"===e.code&&(e.preventDefault(),keyListener(e))}document.addEventListener("DOMContentLoaded",(()=>{if(regionMetaTag=document.querySelector("meta[name='isRegionalized']"),regionListMetaTag=document.querySelector("meta[name='RegionList']"),isOpen){document.querySelector("body").addEventListener("keydown",checkTabPress)}if(regionMetaTagContent=regionMetaTag.content,"false"!==regionMetaTagContent){isRegionalizedPage(),document.getElementById("cbds-textInput")?.addEventListener("input",(function(e){5===e.target.value.length&&e.target.value?"00000"===e.target.value?(showError(e.target),document.getElementById("dcom-zip-modal-submit").disabled=!0,document.getElementById("dcom-zip-modal-submit").ariaDisabled=!0):(hideError(e.target),document.getElementById("dcom-zip-modal-submit").classList.remove("cbds-is-disabled"),document.getElementById("dcom-zip-modal-submit").disabled=!1,document.getElementById("dcom-zip-modal-submit").ariaDisabled=!1,zipCodeVal=e.target.value):(hideError(e.target),document.getElementById("dcom-zip-modal-submit").disabled=!0,document.getElementById("dcom-zip-modal-submit").ariaDisabled=!0)}));const e=e=>!(8!==e&&0!==e&&(e<48||e>57));document.getElementById("cbds-textInput")?.addEventListener("keypress",(function(t){if(onlyNumberKey(t),"Enter"!==t.code)return"Tab"===t.code?(t.preventDefault(),void tabWithinModal(t)):e(t.which);document.getElementById("dcom-zip-modal-submit").click()}));$("#cbds-textInput").bind("keydown",(function(e){9===e.keyCode&&(e.preventDefault(),tabWithinModal(e))})).bind("focusout",(function(e){tabWithinModal(e),e.preventDefault()})),document.getElementById("dcom-zip-modal-submit")?.addEventListener("click",(function(e){e.preventDefault(),document.getElementById("dcom-zip-modal-submit").classList.contains("cbds-is-disabled")||submitModal(zipCodeVal,e)})),document.getElementById("dcom-zip-modal-submit")?.addEventListener("keyup",(function(e){"Enter"===e.code&&(e.preventDefault(),document.getElementById("dcom-zip-modal-submit").classList.contains("cbds-is-disabled")||submitModal(zipCodeVal,e))})),document.getElementById("dcom-zip-modal-submit")?.addEventListener("keydown",(function(e){"Tab"===e.code&&(e.preventDefault(),tabWithinModal(e))})),document.getElementById("dcom-zip-modal-close")?.addEventListener("click",(function(e){e.preventDefault(),setIsOpen(),closeModal(itemFocus,keyFlag,e)})),document.getElementById("cbds-modal")?.addEventListener("click",(function(e){const t=document.querySelector(".cbds-c-overlay--dark");e.target.contains(t)&&(e.preventDefault(),setIsOpen(),closeModal(itemFocus,keyFlag,e))})),document.getElementById("dcom-zip-modal-close")?.addEventListener("keydown",(function(e){"Tab"===e.code&&(e.preventDefault(),tabWithinModal(e)),"Enter"===e.code&&(e.preventDefault(),setIsOpen(),keyFlag=!0,closeModal(itemFocus,keyFlag,e))})),document.getElementById("dcom-c-zipcomponent-update")?.addEventListener("click",(function(e){clickTabModelEvent(e,".modal-trigger")})),document.getElementById("dcom-c-location-banner")?.addEventListener("click",(function(e){clickTabModelEvent(e,".modal-trigger-banner")}))}}));const submitModal=(e,t)=>{5===e.length?(setIsOpen(),getRegionZipCode(e),closeModal()):showError(t.target)},getRegionZipCode=e=>{$.ajax({url:ZIP_CONFIG_URL+e,type:"GET",dataType:"json"}).done((e=>{void 0===e.RegionZipCodeMapping[0].Region&&null===e.RegionZipCodeMapping[0].Region||createRegionCookie(e.RegionZipCodeMapping[0])})).fail((e=>{console.log(e.statusText),getRegionZipCode("02919")}))},createRegionCookie=e=>{let t,o;t=e.hasOwnProperty("Region")&&e.Region||"",o=e.hasOwnProperty("ZipCode")&&e.ZipCode||"";let n=["RegionID=",t,"&Zip=",o].join("");setCookie("Region",n,MAX_COOKIE_DAYS),setCookie("RegionTemp",n,MAX_COOKIE_DAYS),regionMetaTag=document.querySelector("meta[name='isRegionalized']"),regionListMetaTag=document.querySelector("meta[name='RegionList']"),regionMetaTagContent=regionMetaTag.content,"false"!==regionMetaTagContent&&isRegionalizedPage(),location.reload()},setIsOF=e=>{const t=document.querySelector("#dcom_location_banner");e?t?.classList.remove("cbds-u-display__none"):t?.classList.add("cbds-u-display__none")},setCookie=(e,t,o)=>{let n;if(o){const e=new Date;e.setTime(e.getTime()+24*o*60*60*1e3),n="expires="+e.toUTCString()}else n="";1===HOST.split(".").length?document.cookie=e+"="+t+";"+n+";path=/":(domainParts=HOST.split("."),domainParts.shift(),domain="."+domainParts.join("."),document.cookie=e+"="+t+";"+n+";path=/;domain="+domain,null!=getCookie(e)&&getCookie(e)==t||(domain="."+HOST,document.cookie=e+"="+t+n+"; path=/; domain="+domain))},closeModal=(e,t,o)=>{if(document.querySelector("#cbds-modal")&&document.querySelector("#cbds-modal").classList.add("cbds-u-display__none"),t){document.querySelectorAll(e)[0].focus()}},tabWithinModal=e=>{if(!isOpen)return;if(document.getElementById("cbds-modal")){const t=document.getElementById("cbds-modal").querySelectorAll("a[href]:not([disabled]), button:disabled, button:not([disabled]), textarea:not([disabled]), input[type='text']:not([disabled]), input[type='radio']:not([disabled]), input[type='checkbox']:not([disabled]), select:not([disabled])"),o=t[0],n=t[1],i=t[t.length-1];if(e.shiftKey&&document.activeElement===o)return i.focus(),void e.preventDefault();if(e.shiftKey&&document.activeElement===i)return n.focus(),void e.preventDefault();if(e.shiftKey&&document.activeElement===n)return o.focus(),void e.preventDefault();if(!e.shiftKey&&document.activeElement===i)return o.focus(),void e.preventDefault();if(!e.shiftKey&&document.activeElement===o)return n.focus(),void e.preventDefault();if(!e.shiftKey&&document.activeElement===n)return n.blur(),i.focus(),void e.preventDefault();if(!e.shiftKey&&"focusout"!==e.type)return o.focus(),void e.preventDefault();if("focusout"===e.type)return n.blur(),o.focus(),void e.preventDefault()}},keyListenersMap=new Map([[9,tabWithinModal]]);function keyListener(e){const t=keyListenersMap.get(e.keyCode);return t&&t(e)}function clickTabModelEvent(e,t){"Enter"===e.code&&(e.preventDefault(),setIsOpen(),isOpen&&tabWithinModal(e)),"click"===e.type&&(itemFocus=t,keyFlag=!0,e.preventDefault(),e.keyCode=13,setIsOpen(),setIsOpen(),document.getElementById("dcom-zip-modal-submit")?.classList.add("cbds-is-disabled"),document.getElementById("cbds-textInput").value="",document.getElementById("cbds-textInput")?.classList.remove("cbds-is-invalid"),document.getElementById("cbds-textInput").setAttribute("aria-invalid",!1),document.getElementById("cbds-textInput")?.nextElementSibling.classList.add("cbds-u-display__none"),showZipCodeModal(),isOpen&&tabWithinModal(e))}regionMetaTag=document.querySelector("meta[name='isRegionalized']"),regionListMetaTag=document.querySelector("meta[name='RegionList']"),regionMetaTagContent=regionMetaTag.content,"false"!==regionMetaTagContent&&isRegionalizedPage();